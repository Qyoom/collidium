<!DOCTYPE html>
<html>
<link href="http://shadaj.me/bootstrap.css" rel="stylesheet">

<a href="https://github.com/shadaj/collidium" target="_new"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>
<head>
  <title>Collidium Online</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
</head>
<body>
	<div class="container">
		<div class="masthead">
			<h3 class="muted">Collidium Online</h3>
		</div>
		<div class="row-fluid">
			<div class="span9">
				<audio hidden id="youWonAudio">
				  	<source src="assets/YouWon.ogg" type="audio/ogg" />
					<source src="assets/YouWon.mp3" type="audio/mpeg" />
				</audio>
				<audio hidden loop id="backgroundAudio">
					<source src="assets/backgroundMusic.ogg" type="audio/ogg" />
				 	<source src="assets/backgroundMusic.mp3" type="audio/mpeg" />
				</audio>
				<div>
					<p>Web version of <a href="https://github.com/shadaj/collidium-desktop" target="_new">collidium-desktop</a> written in Scala.</p>
					<p>Made possible by the AWESOME <a href="http://lampwww.epfl.ch/~doeraene/scala-js/" target="_new">scala.js!</a></p>
					<p>Source code available <a href="http://github.com/shadaj/collidium-online" target="_new">here</a></p>
				    <h2>How to play:</h2>
				    <ul>
				      	<li>Choose a level using the combobox and the jump button</li>
				    	<li>Before launching the orange ball by it back, you can draw obstacles that the ball will bounce off.</li>
			    		<li>Try to get the ball into the red circle!</li>
			      		<li>More levels coming soon!</li>
			    	</ul>
			  		<img src="./assets/Loading_Key.gif" alt="Loading..." id="loadingImage" style="margin:250px"></img>
				</div>
			
				<canvas id="canvas" width="500" height="500" style="position: relative"></canvas>
				<div class="controls">
					<select id="levelChooser">
				  		<option value="level0">Level 0</option>
				  		<option value="level1">Level 1</option>
					</select>
					<a class="btn btn-inverse" onClick="jumpLevel()">Jump!</a>
				</div>
				<hr>
				<div>
					<a class="btn btn-primary btn-large" href="http://shadaj.me">Visit my main website!</a>
				</div>
			</div>
		</div>
	</div>
</body>
<script type="text/javascript" src="./levels.json"></script>
<script>
function startGame () {
  console.log("loading collidium")
  var collidiumScript = document.createElement("script")
  collidiumScript.type="text/javascript"
  collidiumScript.onload = function () {
    loadBox2D()
  }

  collidiumScript.async = true
  collidiumScript.src = "./target/scala-2.10/collidium.js"
  var body = document.getElementsByTagName("body")[0]
  body.appendChild(collidiumScript)
}

function jumpLevel() {
  ScalaJS.modules.me\ufe33shadaj\ufe33collidium\ufe33Main().levelJump();
}

function loadBox2D () {
  console.log("loading box2d")
  document.getElementById("loadingImage").hidden = true
  var box2DScript = document.createElement("script")
  box2DScript.type="text/javascript"
  box2DScript.onload = function () {
  	console.log("loaded box2d")
    startMain()
  }

  box2DScript.async = true
  box2DScript.src = "https://raw.github.com/kripken/box2d.js/c4d0d8f4176f863229335941d2865732c7e2320e/box2d.js"
  var body = document.getElementsByTagName("body")[0]
  body.appendChild(box2DScript)
}
</script>

<script type="text/javascript" async onload="startGame()" src="./js/scalajs-runtime.js"></script>

<script>
  function startMain () {
  	console.log("starting game")
    ScalaJS.modules.me\ufe33shadaj\ufe33collidium\ufe33Main().main();
  }
</script>
</html>